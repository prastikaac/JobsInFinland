<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Iframe Example</title>
    <!-- Include Firebase library scripts -->
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>
    <style>
        body {
            background: black;
            margin: 0;
            overflow: hidden; /* Prevent scrolling */
        }
        iframe {
            width: 100vw;  /* Full viewport width */
            height: 100vh; /* Full viewport height */
            border: none;
        }
        section {
            position: relative;
            height: 100vh; /* Full viewport height */
        }
        h1 {
            color: white;
            text-align: center;
            margin: 0;
            padding: 1rem;
            background: black;
        }
        #iframe-container {
            display: flex;
            flex-direction: column;
        }
    </style>
</head>
<body>
    <div id="iframe-container"></div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBiVc598fJn7WmgGVivUvZyKRBNfrug75U",
            authDomain: "noteswift-login.firebaseapp.com",
            projectId: "noteswift-login",
            storageBucket: "noteswift-login.appspot.com",
            messagingSenderId: "227729152808",
            appId: "1:227729152808:web:445ffda231ae7baf8a4e1d",
            measurementId: "G-Y3GZ6HDWF4"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Reference to the lectures directory
        const lecturesRef = database.ref('/files/Class 12/class-12-chemistry/chapter-21/Lectures');

        // Function to modify iframe URL for autoplay
        function modifyIframeSrcForAutoplay(iframeHtml) {
            const parser = new DOMParser();
            const doc = parser.parseFromString(iframeHtml, 'text/html');
            const iframe = doc.querySelector('iframe');

            if (iframe && iframe.src) {
                const url = new URL(iframe.src);
                // Modify URL based on the hostname (for autoplay)
                if (url.hostname.includes('youtube.com') || url.hostname.includes('youtu.be')) {
                    url.searchParams.set('autoplay', '1');
                } else if (url.hostname.includes('vimeo.com')) {
                    url.searchParams.set('autoplay', '1');
                } else {
                    url.searchParams.set('autoplay', '1');
                }
                iframe.src = url.toString();
                return iframe.outerHTML;
            }
            return iframeHtml;
        }

        // Fetch all lectures
        lecturesRef.once('value')
            .then((snapshot) => {
                const lecturesData = snapshot.val();
                console.log("Lectures Data:", lecturesData);

                if (lecturesData) {
                    const iframeContainer = document.getElementById('iframe-container');
                    iframeContainer.innerHTML = '';

                    const hash = window.location.hash.substring(1);

                    Object.keys(lecturesData).forEach((lectureKey) => {
                        const lectureData = lecturesData[lectureKey];
                        let iframeHtml = lectureData.url;
                        console.log("Lecture Key:", lectureKey, "Iframe HTML:", iframeHtml);

                        if (iframeHtml) {
                            if (lectureKey === hash) {
                                iframeHtml = modifyIframeSrcForAutoplay(iframeHtml);
                            }

                            const section = document.createElement('section');
                            section.id = lectureKey;

                            const anchor = document.createElement('a');
                            anchor.name = lectureKey;

                            const iframeWrapper = document.createElement('div');
                            iframeWrapper.innerHTML = iframeHtml;

                            section.appendChild(anchor);
                            section.appendChild(iframeWrapper);

                            iframeContainer.appendChild(section);
                        } else {
                            const errorMsg = document.createElement('p');
                            errorMsg.textContent = 'No iframe available for ' + lectureKey;
                            iframeContainer.appendChild(errorMsg);
                        }
                    });

                    if (hash) {
                        const targetSection = document.getElementById(hash);
                        if (targetSection) {
                            targetSection.scrollIntoView();
                        }
                    }
                } else {
                    document.getElementById('iframe-container').innerHTML = 'No lectures available.';
                }
            })
            .catch((error) => {
                console.error('Error fetching lectures:', error);
                document.getElementById('iframe-container').innerHTML = 'Error fetching lectures.';
            });
    </script>
 <script>
        if ('serviceWorker' in navigator) {
          navigator.serviceWorker.register('/service-worker.js')
            .then((registration) => {
              console.log('Service Worker registered with scope:', registration.scope);
            })
            .catch((error) => {
              console.error('Service Worker registration failed:', error);
            });
        }
      </script>
   <script src="js/gt.min.js" data-gt-widget-id="43217984"></script>
</body>

</html>
